<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="refresh" content="180">
    <link rel="stylesheet" href="https://cdn.staticfile.org/twitter-bootstrap/3.3.7/css/bootstrap.min.css">
    <script src="https://cdn.staticfile.org/jquery/2.1.1/jquery.min.js"></script>
    <script src="https://cdn.staticfile.org/twitter-bootstrap/3.3.7/js/bootstrap.min.js"></script>
    <!--<script src="js/newbian.js"></script>
    <script src="js/newbter.js"></script>
    -->


    <!-- Latest compiled and minified CSS -->
    <!--<link rel="stylesheet" href="https://unpkg.com/bootstrap-table@1.15.3/dist/bootstrap-table.min.css">
     Latest compiled and minified JavaScript -->

    <!--<script src="https://unpkg.com/bootstrap-table@1.15.3/dist/bootstrap-table.min.js"></script>-->
    <!--Latest compiled and minified Locales -->
    <!--
    <script src="https://unpkg.com/bootstrap-table@1.15.3/dist/locale/bootstrap-table-zh-CN.min.js"></script>
    -->

    <script src="js/newre.js"></script>
    <script src="js/newhb.js"></script>
    <script src="js/newbian.js"></script>
    <script src="js/newbter.js"></script>
    <script src="js/newok.js"></script>
    <script src="js/newmc.js"></script>
    <script src="js/newzb.js"></script>
    <script src="js/newbs.js"></script>
    <script src="js/newkb.js"></script>

    <script type="text/javascript">
        setInterval(testsession,10000);
        function testsession()
        {
            //sessionStorage
            $(document).ready ( function(){
                $.ajax({
                    type:"GET",
                    url:"/check",
                    async:false,
                    dataType:'json',
                    success:function(result){
                        if(result.code=='0'||result.code=='2')//0未找到 2空白页
                        {
                            alert('登录失效');

                            self.location="\\";
                            //closeallsocket();
                        }
                    }
                })});
        }
        /*function deleteuser()
        {
            $(document).ready ( function() {
                $.ajax({
                    type: "GET",
                    url: "/deleteUser",
                    async: false,
                    dataType: 'json',
                    success: function (result) {
                        alert(result.code);
                    }
                });
            });
        }*/
    </script>
    <title>NewSocket</title>
    <script type="text/javascript">
        function changepercent(value) {
            //清理页面数据
            $("#table_content")[0].innerHTML="";
            percent_base=value;
        };
        function buttonclick() {
            $("[data-toggle='popover']").popover();
        }

        $(document).ready(function(){
            $("#table_content").on('click','button',function (e) {
               // alert(e);
               // $(this)[0].attributes[7].textContent='aaaa';
                //$("[data-toggle='popover']").popover();
                f1(this,f2);
            });
        });
        function f1(aa,callback) {
           // $(aa)[0].attributes[7].textContent='aaaa';
            callback();
        }
        function f2() {
            $("[data-toggle='popover']").popover();
        }
    </script>
</head>
<body>
<div>
    <div style="width:150px;display: inline">
    <h4>获利比率选择 <span class="label label-default"></span></h4>
    </div>
    <div style="width: 100px ;display: inline">
    <select class="selectpicker" onchange="changepercent(this.value)">
        <option value="0.03">3%</option>
        <option value="0.04">4%</option>
        <option value="0.05">5%</option>
        <option value="0.06">6%</option>
        <option value="0.07">7%</option>
        <option value="0.08">8%</option>
        <option value="0.09" selected>9%</option>
        <option value="0.10">10%</option>
        <option value="0.11">11%</option>
        <option value="0.12">12%</option>
        <option value="0.13">13%</option>
        <option value="0.14">14%</option>
        <option value="0.15">15%</option>
    </select>
    </div>
    <div style="display: inline">
        <div style="display: block">
        <p>火币</p>
        </div>
        <div style="display: block">
            <p>币安</p>
        </div>
    </div>
</div>
<table class="table table-striped table-hover" data-toggle="table" id="tbody" data-sortable="true" data-search="true">
    <tr class="active">
        <th>币种</th>
        <th  data-sortable="true">获利比率</th>
        <th>买入机构</th>
        <th>买入交易对</th>
        <th>买入单价</th>
        <th>卖出机构</th>
        <th>卖出交易对</th>
        <th>卖出单价</th>
    </tr>
    <tbody id="table_content">
    <!--<tr class="success">
        <td>产品2</td>
        <td>10/11/2013</td>
        <td>发货中</td></tr>
    <tr class="warning">
        <td>产品3</td>
        <td>20/10/2013</td>
        <td>待确认</td></tr>
    <tr class="danger">
        <td>产品4</td>
        <td>20/10/2013</td>
        <td>已退货</td></tr>
        -->
    </tbody>
</table>
</body>
<script type="text/javascript">
    window.onload=function () {
        testsession();
    };
    window.onclose=function(){
        //从服务删除用户
       // deleteuser();
    };
    //监听窗口关闭事件，当窗口关闭时，主动去关闭websocket连接，防止连接还没断开就关闭窗口，server端会抛异常。
    window.onbeforeunload = function (e) {

        closeallsocket();
    };
    window.onunload=function(){
        //从服务删除用户
        //deleteuser();
    };
    //关闭所有socket
    function closeallsocket() {
        websocketre.close();
        websockethb.close();
        websocketok.close();
        websocketzb.close();
        websocketmc.close();
        websocketbter.close();
        websocketbian.close();
        websocketbs.close();
        websocketkb.close();
    }
</script>
</html>